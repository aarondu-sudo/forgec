#!/usr/bin/env bash
set -euo pipefail
ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
OUT_DIR="$ROOT/dist"
mkdir -p "$OUT_DIR"
EXT="so"
case "$(uname -s)" in
  Darwin) EXT="dylib" ;;
  *) EXT="so" ;;
esac
LIB="$OUT_DIR/lib{{ .ModName }}.$EXT"
echo "Building $LIB"
go build -buildmode=c-shared -o "$LIB" "$ROOT"
echo "OK -> $LIB"

